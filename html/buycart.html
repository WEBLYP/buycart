<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>购物车</title>
    <link rel="stylesheet" href="../css/swiper.css">
    <link rel="stylesheet" href="../libs/weui/weui.min.css">
    <link rel="stylesheet" href="../libs/weui/jquery-weui.css">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/style.css">
    <script src="../libs/jquery.min.js"></script>
    <script src="../js/swiper.js"></script>
    <script src="../libs/fastclick.min.js"></script>
    <script src="../libs/weui/weui.min.js"></script>
    <script src="../libs/weui/jquery-weui.min.js"></script>
    <script src="../libs/lewee.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/least.js"></script>
</head>
<body>
<!--购物车-->
<div class="weui-tab buycart">
    <div class="content">
        <div class="top flex"><span>购物车</span> <span data-status="1"  class="themecolor editor show">编辑</span> <span data-status="2" class="themecolor editor">完成</span></div>

        <ul class="middle carts">
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">999.99</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">999.99</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">200.00</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">300.00</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">200.00</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">270.90</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
            <li>
                <div class="icon"></div>
                <div class="img">
                    <img src="../images/pro.png" alt="">
                </div>
                <div class="info">
                    <h1>雅诗兰黛口红333 哑光唇膏</h1>
                    <p class="text">滋润 柔滑 一步到位</p>
                    <div class="flex shuliang">
                        <p><span class="themecolor">￥</span><span class="themecolor oneprice">270.60</span></p>
                        <p class="number">×<span class="num">1</span></p>
                        <div class="flex changenum" ><label class="reduce" for="reduce">-</label><input name="num[]" type="text" value="1"> <label class="add" for="add">+</label></div>
                    </div>
                </div>
            </li>
        </ul>

        <div class="bottom flex">
            <div class="allselect flex"><span class="icon"></span>全选</div>
            <div class="allprice">
                <div class="flex">合计 <p class="themecolor">￥<span class="totalprice">0.00</span></p></div>
                <div class="flex"><p>共<span class="totalnum">1</span>件</p></div>
            </div>
            <a href="" class="gotobalance show">去结算</a>
            <a href="JavaScript:;" class="gotobalance del">删除</a>
        </div>
    </div>
    <div class="weui-tabbar">
        <a href="javascript:;" class="weui-tabbar__item shouye">
            <div class="weui-tabbar__icon">

            </div>
            <p class="weui-tabbar__label">首页</p>
        </a>
        <a href="javascript:;" class="weui-tabbar__item zhuanti">
            <div class="weui-tabbar__icon">

            </div>
            <p class="weui-tabbar__label">专题</p>
        </a>
        <a href="javascript:;" class="weui-tabbar__item gouwuche">
            <div class="weui-tabbar__icon">

            </div>
            <p class="weui-tabbar__label">购物车</p>
        </a>
        <a href="javascript:;" class="weui-tabbar__item dingdan">
            <div class="weui-tabbar__icon">

            </div>
            <p class="weui-tabbar__label">提货订单</p>
        </a>
        <a href="javascript:;" class="weui-tabbar__item wode">
            <div class="weui-tabbar__icon">

            </div>
            <p class="weui-tabbar__label">我的</p>
        </a>
    </div>
</div>
</body>
<script>
    /*购物车*/


    /*编辑or完成*/
    $('.editor').click(function () {
        $(this).hide().siblings().show();
        $('.gotobalance').toggleClass('show');
        var status=$(this).attr('data-status');
        if(status==1){
           $('.number').hide();
           $('.changenum').css('display','flex');
        }
        else{
            $('.changenum').hide();
            $('.number').show();
        }
    });

    /*合计*/
    function total() {
        var totalPrice = 0;
        var totalNum = 0;
        var price = 0;
        var nums = 0;

        $('li').each(function (e,index) {
            var that=$(this);
            if(that.find('.icon').hasClass('selected'))
            {
                price =that.find('.oneprice').text();
                nums = that.find('input[name=num\\[\\]]').val();
                totalPrice=totalPrice+price*nums;
                totalNum = parseFloat(totalNum) + parseFloat(nums);
            }
        });
        $('.totalnum').text(totalNum);
        $('.totalprice').text(totalPrice.toFixed(2));/*小数点后2位四舍五入*/
    };

     /*减*/
     $('.reduce').click(function () {
         var input=$(this).parents('.changenum').find('input');
         var num=input.val();
         if(num>1){input.val(--num)};
         $(this).parents('.shuliang').find('.num').text(num);
         total()
     });

     /*加*/
    $('.add').click(function () {
        var input=$(this).parents('.changenum').find('input');
        var num=input.val();
        if(num<99){input.val(++num)};
        $(this).parents('.shuliang').find('.num').text(num);
        total()
    });

     /*全选*/
    $('.allselect').click(function () {
        $(this).find('.icon').toggleClass('selected');
        if($(this).find('.icon').hasClass('selected')){
            $('.icon').addClass('selected');
        }else{
            $('.icon').removeClass('selected');
        };
        total()
    });

    /*单选*/
    $('.icon').click(function () {
        $(this).toggleClass('selected');
        var $length=$('li .icon').length;
        if($('li .icon.selected').length==$length){
            $('.allselect .icon').addClass('selected')
        }
        else{
            $('.allselect .icon').removeClass('selected')
        };
        total()
    });

    /*删除*/
    $('.gotobalance.del').click(function () {

        $('li').each(function () {
            if($(this).find('.icon').hasClass('selected')){
                $(this).remove()
            }
        });
        total()
    });

    /*输入范围限制1-99*/
    $("li input").on("input",function (e){
        e.stopPropagation();
        /*1~99*/
        $(this).val()>=99?$(this).val(99):$(this).val();
        $(this).val()<=1?$(this).val(1):$(this).val();
        var s = $(this).val();
        // 如果输入的不是数字，让它的值为1
        if(isNaN(s)){
            $(this).val('1');
        }
        total()
    });

</script>
</html>